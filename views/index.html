<!DOCTYPE html>

<script>
    window.addEventListener("load", async function()
    { display_weather_data(await get_weather(), document.body) });

    async function get_weather(country="Glasgow")
    {
        let response = await fetch(`/data/weather?c=${country}`)
        response = await response.json()
        return response
    }

    async function get_headlines(country="us") 
    {
        let response = await fetch(`/data/headlines?c=${country}`)
        response = await response.json()
        return response
    } 


    async function display_weather_data(weather_data, parent_item)
    {   
        let ifram = parent_item.ownerDocument.createElement("iframe")
        ifram.setAttribute("src", "weather_data_template.html")
        parent_item.append(ifram)
        
        //TODO: make this work with the onload event instead so an arbitrary wait time is no longer needed
        setTimeout(() => { ifram.contentWindow.populate(weather_data) }, 100)
    }
    
    //TODO: make this work like the display_weather_data (once display_weather_data is fixed)
    function display_headline_data(headline_data)
    {   
        let ifram = parent_item.ownerDocument.createElement("iframe")
        ifram.setAttribute("src", "headline_data_template.html")
        parent_item.append(ifram)
        
        //TODO: make this work with the onload event instead so an arbitrary wait time is no longer needed
        setTimeout(() => { ifram.contentWindow.populate(weather_data) }, 100)
    }

    //TODO: get a friend so this function is no longer null â˜¹
    function get_friends() 
    {
        return null
    }
</script>

</html>
